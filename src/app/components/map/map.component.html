<div class="main-content "id="mapid" style="min-height: -webkit-fill-available;" >
    <div #mapContainer id="formulario" class="formulario-flotante" style="margin-left: 0%" (click)="stopPropagation($event)">
        <div class="input-group mb-3">
            <span class="input-group-text" style="background-color: white;" (mouseenter)="showCrosshair = true" (mouseleave)="showCrosshair = false" (click)="getLocation()">
                <i *ngIf="!showCrosshair" class="bi bi-search"></i>
                <i *ngIf="showCrosshair" class="bi bi-crosshair"></i>
              </span>
              
            <input class="form-control" type="text" placeholder="Buscar un barrio" aria-label="Number" [formControl]="myControl" (input)="filterOptions($event.target)" (blur)="hideOptions()" (mousedown)="stopPropagation($event)" (mouseup)="stopPropagation($event)" (touchmove)="stopPropagation($event)">        
            
            <button class="btn btn-primary" type="button" id="button-addon1" (click)="reloadmap()"  ngbPopover="Barrios" ngbPopoverTrigger="mouseenter"><i class="bi bi-eye-fill" *ngIf="!capaActiva"></i> <i class="bi bi-eye-slash-fill" *ngIf="capaActiva"></i></button>
            <button type="button" class="btn btn-primary" ngbPopover="Puntos Wifi" (click)="reloadWifi()" ngbPopoverTrigger="mouseenter" ><i class="bi bi-wifi" *ngIf="!capaActivaWIFI"></i> <i class="bi bi-wifi-off" *ngIf="capaActivaWIFI"></i></button>
            <button class="btn btn-primary" (click)="activarPopups()" *ngIf="!capaActivaWIFI && !isMobile()"><i class="bi bi-caret-right"></i></button>


        </div>
        <ul *ngIf="lista_feature.length > 0 && showOptions" class="options-list list-group" (touch)="stopPropagation($event)" (click)="stopPropagation($event)"  (touchmove)="stopPropagation($event)"  >
            <ng-container *ngFor="let option of filter">
                <li class="list-group-item" (click)="buscar(option);stopPropagation($event)" (touch)="stopPropagation($event)" (touchend)="buscar(option)"    *ngIf="option.properties.nombre">{{ option.properties.nombre }}</li>
            </ng-container>
        </ul>
        <div class="dropdown" *ngIf="opcionb" style="display: inline-block!important">
            <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="bi bi-journal-bookmark-fill"></i> Fichas
            </button>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                <a class="dropdown-item" href="javascript:void(0)" (click)="fichaTecnica()">Fichas</a>
                <a class="dropdown-item" href="javascript:void(0)" (click)="nuevoFicha()">Nueva Ficha</a>
            </div>
        </div>
    <!--d-md-inline-block-->
        <div class="dropdown" *ngIf="opcionb" style="display: inline-block!important">
            <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="bi bi-journal-bookmark-fill"></i> Incidentes
            </button>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                <a class="dropdown-item" href="javascript:void(0)" (click)="incidente()">Incidentes</a>
                <a class="dropdown-item" href="javascript:void(0)" (click)="nuevoIncidente()">Nuevo Incidente</a>
            </div>
        </div>
        
          
            
    </div>
    
    <div #mapContainer2 class="container" id="listarficha" *ngIf="mostrarficha" (click)="stopPropagation($event)" >
        <app-index-ficha-sectorial class="container" id="indexficha"  [filtro]="'direccion_geo'" [valor]="opcionb.properties.nombre" [modal]="true">
        </app-index-ficha-sectorial>
    </div>
    <div #mapContainer2 class="container" id="listarficha" *ngIf="mostrarincidente" (click)="stopPropagation($event)" >
        <app-index-incidentes-denuncia class="container" id="indexficha"  [filtro]="'direccion_geo'" [valor]="opcionb.properties.nombre" [modal]="true">
        </app-index-incidentes-denuncia>
    </div>
    <!-- Modal -->
    <ng-template #modalContent let-modal>
        <div class="modal-content">
            <div class="modal-header">
            <h1 class="modal-title fs-5" id="exampleModalLabel">Seleccionar Ubicación</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" (click)="modal.dismiss()"></button>
            </div>
            <div class="modal-body">
                ¿Desea seleccionar una capa georeferenciada? o definir una latitud y longitud exacta?
            </div>
            <div class="modal-footer">
                
            <button type="button" class="btn btn-primary" (click)="modal.close('barrio')">Barrio</button>
            <button type="button" class="btn btn-secondary" (click)="modal.close('coordenadas')" data-bs-dismiss="modal">Coordenadas</button>
            </div>
        </div>
      </ng-template>

      <ng-template #modalContentUbicacion let-modal>
        <div class="modal-header">
          <h4 class="modal-title">Confirmar ubicación</h4>
          <button type="button" class="close" aria-label="Close" (click)="modal.dismiss()">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          ¿Desea usar su ubicación actual?
        </div>
        <div class="modal-footer">
            
          <button type="button" class="btn btn-primary" (click)="modal.close(true)">Aceptar</button>
          <button type="button" class="btn btn-secondary" (click)="modal.dismiss()">Cancelar</button>
        </div>
      </ng-template>

      <ng-template #modalCambiodeUbicacion let-modal>
        <div class="modal-header">
          <h4 class="modal-title">Confirmar ubicación</h4>
          <button type="button" class="close" aria-label="Close" (click)="modal.dismiss()">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          ¿Desea usar su ubicación actual?
        </div>
        <div class="modal-footer">
            
          <button type="button" class="btn btn-primary" (click)="modal.close(true)">Aceptar</button>
          <button type="button" class="btn btn-secondary" (click)="modal.dismiss()">Cancelar</button>
        </div>
      </ng-template>
    
</div>

