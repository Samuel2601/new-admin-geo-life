<div class="card">
    <div class="card-header">
        <div class="row">
            <div class="col-auto">
                <h2>Listado de Encargados de Categoría</h2>
            </div>
            <div class="col-6">
                <p-button
                    icon="pi pi-briefcase"
                    label="Nuevo Encargado de Categoría"
                    (click)="newencargado()"
                ></p-button>
            </div>
        </div>
    </div>
    <div class="card-body">
        <p-toast></p-toast>
        <div class="table-responsive-sm">
            <p-table [paginatorDropdownAppendTo]="'body'"
                styleClass="p-datatable-striped"
                [value]="encargadosCategoria"
                dataKey="_id"
                currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} registros"
                [tableStyle]="{ 'min-width': '60rem' }"
            >
                <ng-template pTemplate="header">
                    <tr>
                        <th style="width: 5rem"></th>
                        <th pSortableColumn="categoria.nombre">
                            Categoria
                            <p-sortIcon field="categoria.nombre"></p-sortIcon>
                        </th>
                        <th pSortableColumn="categoria.descripcion">
                            Descripción
                            <p-sortIcon
                                field="categoria.descripcion"
                            ></p-sortIcon>
                        </th>
                    </tr>
                </ng-template>
                <ng-template
                    pTemplate="body"
                    let-encargadoCategoria
                    let-expanded="expanded"
                >
                    <tr>
                        <td>
                            <button
                                type="button"
                                pButton
                                pRipple
                                [pRowToggler]="encargadoCategoria"
                                class="p-button-text p-button-rounded p-button-plain"
                                [icon]="
                                    expanded
                                        ? 'pi pi-chevron-down'
                                        : 'pi pi-chevron-right'
                                "
                            ></button>
                        </td>
                        <td *ngIf="encargadoCategoria.categoria">{{ encargadoCategoria.categoria.nombre }}</td>
                        <td *ngIf="encargadoCategoria.categoria">{{ encargadoCategoria.categoria.descripcion }}</td>
                    </tr>
                </ng-template>
                <ng-template pTemplate="rowexpansion" let-encargadoCategoria>
                    <tr>
                        <td colspan="3">
                            <div class="p-3">
                                <p-table [paginatorDropdownAppendTo]="'body'"
                                    currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} registros"
                                    [value]="encargadoCategoria.encargado"
                                    dataKey="_id"
                                >
                                    <ng-template pTemplate="header">
                                        <tr>
                                            <th pSortableColumn="nombres">
                                                Nombres
                                                <p-sortIcon
                                                    field="nombres"
                                                ></p-sortIcon>
                                            </th>
                                            <th pSortableColumn="correo">
                                                Correo
                                                <p-sortIcon
                                                    field="correo"
                                                ></p-sortIcon>
                                            </th>
                                            <th pSortableColumn="estado">
                                                Estado
                                                <p-sortIcon
                                                    field="estado"
                                                ></p-sortIcon>
                                            </th>
                                            <th style="width: 4rem"></th>
                                        </tr>
                                    </ng-template>
                                    <ng-template pTemplate="body" let-order>
                                        <tr>
                                            <td>{{ order.nombres }}</td>
                                            <td>{{ order.correo }}</td>
                                            <td>{{ order.estado }}</td>
                                        </tr>
                                    </ng-template>
                                    <ng-template pTemplate="emptymessage">
                                        <tr>
                                            <td colspan="6">
                                                No tienes encargados
                                            </td>
                                        </tr>
                                    </ng-template>
                                </p-table>
                            </div>
                        </td>
                    </tr>
                </ng-template>
            </p-table>
        </div>
    </div>
</div>
